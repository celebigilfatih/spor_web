<VirtualHost *:80>
    ServerAdmin admin@sporkulubu.com
    DocumentRoot /var/www/html/public
    ServerName localhost

    # URL Rewriting aktifleştir
    RewriteEngine On
    
    # Ana dizin ayarları
    <Directory /var/www/html/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # URL yeniden yazma kuralları
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.+)$ ../index.php?url=$1 [QSA,L]
    </Directory>

    
    # Upload klasörü güvenliği
    <Directory /var/www/html/public/uploads>
        Options -Indexes -ExecCGI
        AllowOverride None
        Require all granted
        
        # PHP dosyalarının çalıştırılmasını engelle
        <FilesMatch "\.php$">
            Require all denied
        </FilesMatch>
    </Directory>
    
    # Hassas dosyaları gizle
    <FilesMatch "\.(env|htaccess|htpasswd|ini|log|sql)$">
        Require all denied
    </FilesMatch>
    
    # Error ve Access logları
    ErrorLog ${APACHE_LOG_DIR}/spor_kulubu_error.log
    CustomLog ${APACHE_LOG_DIR}/spor_kulubu_access.log combined
    
    # Güvenlik headers (geçici olarak devre dışı)
    # Header always set X-Content-Type-Options nosniff
    # Header always set X-Frame-Options DENY
    # Header always set X-XSS-Protection "1; mode=block"
    # Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
    # Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self'"
</VirtualHost>